(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{"./src/lib/mr-common/mr-request.ts":function(e,n,t){"use strict";t.d(n,"a",function(){return u});var a=t("./src/lib/mr-common/mr.services.ts"),r=t("./node_modules/mzmu/index.js"),o=t.n(r),s=t("./node_modules/axios/index.js"),p=t.n(s);function m(e){return(m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c=p.a.CancelToken;function l(e){var n,t=e.config.resultType,r=e.config.mock;switch(t){case"response":n=e;break;default:n=e.data}return r&&"object"===m(n)&&(n=a.a.mock(n)),Promise.resolve(n)}function i(e){if(p.a.isCancel(e))return Promise.reject(e);var n=e.response;if(!n)return Promise.reject(e);var t=n.headers,r=n.status,o=n.statusText,s=n.data,m=new Promise(function(e){return e(s)}),c={headers:t,status:r,statusText:o,data:s,$message:m,response:n,error:e},l=a.a._reqCatch;return l&&(c=l(c)),"[object Promise]"===Object.prototype.toString.call(c)?c:Promise.reject(c)}function u(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=a.a.getHeaders();return t=o.a.map(t||{},function(e){return"function"===typeof e?e():e}),n.headers=o.a.extend(!0,t,n.headers),n.url=e,o.a.run("function"===typeof n.cancelToken,function(){n.cancelToken=new c(n.cancelToken)}),p()(n).then(l).catch(i)}try{mrrequest.displayName="mrrequest",mrrequest.__docgenInfo={description:'Requests a URL, returning a promise.\n@param url The URL we want to request\n@param options The options we want to pass to "fetch"\n@return An object containing either "data" or "err"',displayName:"mrrequest",props:{}},"undefined"!==typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/lib/mr-common/mr-request.ts#mrrequest"]={docgenInfo:mrrequest.__docgenInfo,name:"mrrequest",path:"src/lib/mr-common/mr-request.ts#mrrequest"})}catch(f){}},"./src/lib/mr-common/mr-resource.mdx":function(e,n,t){"use strict";t.r(n),t.d(n,"default",function(){return u});var a=t("./node_modules/react/index.js"),r=t.n(a),o=t("./node_modules/@mdx-js/tag/dist/index.js");t("./node_modules/docz/dist/index.m.js"),t("./src/lib/mr-common/mr-resource.ts");function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}function m(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,n){return!n||"object"!==s(n)&&"function"!==typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,n){return(i=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}var u=function(e){function n(e){var t;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(t=c(this,l(n).call(this,e))).layout=null,t}var t,a,s;return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&i(e,n)}(n,r.a.Component),t=n,(a=[{key:"render",value:function(){var e=this.props,n=e.components;p(e,["components"]);return r.a.createElement(o.MDXTag,{name:"wrapper",components:n},r.a.createElement(o.MDXTag,{name:"h1",components:n,props:{id:"mrresource"}},"MrResource"),r.a.createElement(o.MDXTag,{name:"p",components:n},"\u57fa\u4e8eMrRequest\u7684RESEful\u63a5\u53e3\u8bf7\u6c42\u534f\u8bae"),r.a.createElement(o.MDXTag,{name:"h2",components:n,props:{id:"basic-usage"}},"Basic usage"),r.a.createElement(o.MDXTag,{name:"pre",components:n},r.a.createElement(o.MDXTag,{name:"code",components:n,parentName:"pre",props:{className:"language-javascript"}},"    let pool = MrResource.pool(api: string);\n\n    /**\n     * \u4f7f\u7528get\u65b9\u6cd5\u5411\u670d\u52a1\u5668\u8bf7\u6c42api\u8d44\u6e90\n     * @params search: any: api \u8bf7\u6c42\u53c2\u6570\n     * @params extraSearch: any: \u989d\u5916\u8bf7\u6c42\u53c2\u6570\uff0c\u5408\u5e76\u81f3 search\n     * @params options: MrRequestOptions fetch \u8bf7\u6c42options\n     * @return Promise\n     */\n\n    // pool.get(search)\n    // pool.get(search, extraSearch, options) \u82e5\u8981\u4f7f\u7528options, \u8bf7\u8865\u5168\u6240\u6709\u53c2\u6570\n    pool.get(search: any, extraSearch?: any, options?: AxiosOptions): Promise;\n\n    /**\n     * \u4f7f\u7528post\u65b9\u6cd5\u5411\u670d\u52a1\u5668\u8bf7\u6c42api\u8d44\u6e90\n     * @params search: any: api \u8bf7\u6c42\u53c2\u6570\n     * @params payload: any: body request payload\n     * @params options: MrRequestOptions fetch \u8bf7\u6c42options\n     * @return Promise\n     */\n\n    // pool.post(payload) \u82e5\u53ea\u6709\u4e00\u4e2a\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u9ed8\u8ba4\u4e3apayload(data)\n    // pool.post(search, payload)\n    // \u82e5\u8981\u4f7f\u7528options, \u8bf7\u8865\u5168\u6240\u6709\u53c2\u6570\n    pool.post(search: any, payload: any, options?: AxiosOptions): Promise;\n\n    /**\n     * mrdown, \u5411\u670d\u52a1\u5668\u5668\u8bf7\u6c42\u4e8c\u8fdb\u5236\u8d44\u6e90\uff0c\u5e76\u6309\u7167 search.downloadName \u8bbe\u7f6e\u7684\u6587\u4ef6\u7c7b\u578b\u4e0b\u8f7d\u6587\u4ef6\n     * MRI \u9ed8\u8ba4\u4e0b\u8f7d\u914d\u7f6e\uff0c\u9ed8\u8ba4post\u8bf7\u6c42\uff0c\u5e76\u6dfb\u52a0\u76f8\u5e94\u914d\u7f6e\u53c2\u6570\uff0c\u82e5\u5176\u4ed6\u8bf7\u4f7f\u7528 download\n     * @params search: any: api \u8bf7\u6c42\u53c2\u6570\uff08\u5176\u4e2d downloadName \u4e3a\u5fc5\u586b\uff09\n     * @params payload: any: body request payload\n     * @params options: MrRequestOptions fetch \u8bf7\u6c42options\n     * @return Promise\n     */\n    pool.mrdown(search: any, payload: any, options?: AxiosOptions): Promise;\n")),r.a.createElement(o.MDXTag,{name:"pre",components:n},r.a.createElement(o.MDXTag,{name:"code",components:n,parentName:"pre",props:{className:"language-javascript"}},"    // let $pool = MrResource.pool(api: string);\n    // api \u8def\u5f84\u63a5\u53d7\u52a8\u6001\u53c2\u6570\u914d\u7f6e, \u4f9d\u636eRESUful\u8bed\u4e49\u89e3\u91ca\n\n    let $pool = MrResource.pool('/users{/:id}/works{/:name}');\n\n    // \u53c2\u6570\u4e3a\u7a7a\n    // api = /users/works\n    // RESUful \u8868\u8ff0\u4e3a: \u6240\u6709\u7528\u6237\u7684\u6240\u6709\u5de5\u4f5c\n    $pool.get({});\n\n    // api = /users/1234/works\n    // RESUful \u8868\u8ff0\u4e3a: ID\u4e3a1234\u7684\u7528\u6237\u7684\u6240\u6709\u5de5\u4f5c\n    $pool.get({id: 1234});\n\n    // api = /users/1234/works/engineer\n    // RESUful \u8868\u8ff0\u4e3a: ID\u4e3a1234\u7684\u7528\u6237\u7684\u5de5\u7a0b\u5e08\u5de5\u4f5c\u4fe1\u606f\n    $pool.get({id: 1234, name: 'engineer'});\n")),r.a.createElement(o.MDXTag,{name:"h2",components:n,props:{id:"\u5360\u4f4d\u7b26--\u4f7f\u7528\u65b9\u6cd5"}},"\u5360\u4f4d\u7b26 {} \u4f7f\u7528\u65b9\u6cd5"),r.a.createElement(o.MDXTag,{name:"ol",components:n},r.a.createElement(o.MDXTag,{name:"li",components:n,parentName:"ol"},"\u5360\u4f4d\u7b26\u53ea\u652f\u6301\u5c5e\u6027\u5360\u4f4d\uff0c\u4e0d\u652f\u6301\u7d22\u5f15\u503c\u5360\u4f4d"),r.a.createElement(o.MDXTag,{name:"li",components:n,parentName:"ol"},"':name:' \u4e24\u4e2a\u5192\u53f7\u95f4':'\u7684name\u4e3a\u5f53\u524d\u5339\u914d\u7684\u5c5e\u6027\u503c"),r.a.createElement(o.MDXTag,{name:"li",components:n,parentName:"ol"},"':name' \u82e5name\u4e3a\u7ed3\u5c3e\uff0c\u5219\u53ef\u4ee5\u7701\u7565\u6700\u540e\u9762\u7684\u5192\u53f7':'"),r.a.createElement(o.MDXTag,{name:"li",components:n,parentName:"ol"},"':' \u5192\u53f7\u4e3a\u533a\u5206\u5c5e\u6027\u503c\u548c\u5360\u4f4d\u503c\u7684\u6807\u8bc6\u7b26")),r.a.createElement(o.MDXTag,{name:"pre",components:n},r.a.createElement(o.MDXTag,{name:"code",components:n,parentName:"pre",props:{className:"language-javascript"}},"// \u4e0b\u9762\u4f8b\u5b50\u4e3a api {} \u5360\u4f4d\u7b26\u7684\u7b49\u6548\u8868\u793a\n\n'{user/:name}' === `user/${name}`;\n\n'{user:name}' === `user${name}`;\n\n'{:name}' === `${name}`;\n\n'{:name:/}' === `${name}/`;\n\n// \u6ce8\u610f\u4e0b\u5217\u662f\u4e0d\u7b49\u4e8e\n// \u6240\u6709\u7684\u5c5e\u6027\u503c\u8868\u793a\u524d\u9762\u5fc5\u987b\u52a0\u5192\u53f7 ':'\n\n'{name}' !== `${name}`;\n\n'{name:/info}' !== `${name}/info`;\n")),r.a.createElement(o.MDXTag,{name:"h3",components:n,props:{id:"\u53d6\u6d88\u8bf7\u6c42\uff08cancel"}},"\u53d6\u6d88\u8bf7\u6c42\uff08cancel)"),r.a.createElement(o.MDXTag,{name:"ul",components:n},r.a.createElement(o.MDXTag,{name:"li",components:n,parentName:"ul"},"\u76ee\u524d\u4ec5\u652f\u6301\u53d6\u6d88\u4e00\u4e2a\u8bf7\u6c42\u4fe1\u606f")),r.a.createElement(o.MDXTag,{name:"pre",components:n},r.a.createElement(o.MDXTag,{name:"code",components:n,parentName:"pre",props:{className:"language-javascript"}},"// \u53d6\u6d88 ajax \u8bf7\u6c42\u4f8b\u5b50\n\nconst cancel;\n\n$pool.nodata.get({}, {}, {\n    cancelToken: (c) => (cancel = c)\n}).then(() => {\n}).catch((error) => {\n    console.debug(error);\n});\n\n// \u53d6\u6d88\u8bf7\u6c42\n// cancel(message?: any): message \u975e\u5fc5\u987b\nlet rst = cancel('cancel ajax');\n\n// rst \u4e3a Cancel\u5bf9\u8c61\u65f6\uff0c\u53d6\u6d88\u8bf7\u6c42\u6210\u529f\n// rst \u4e3a undefined\u65f6\uff0cajax\u8bf7\u6c42\u5df2\u89e6\u53d1\u6210\u529f\n")),r.a.createElement(o.MDXTag,{name:"h2",components:n,props:{id:"properties"}},"Properties"),r.a.createElement(o.MDXTag,{name:"table",components:n},r.a.createElement(o.MDXTag,{name:"thead",components:n,parentName:"table"},r.a.createElement(o.MDXTag,{name:"tr",components:n,parentName:"thead"},r.a.createElement(o.MDXTag,{name:"th",components:n,parentName:"tr",props:{align:"left"}},"Property"),r.a.createElement(o.MDXTag,{name:"th",components:n,parentName:"tr",props:{align:"left"}},"type"),r.a.createElement(o.MDXTag,{name:"th",components:n,parentName:"tr",props:{align:"left"}},"Description"))),r.a.createElement(o.MDXTag,{name:"tbody",components:n,parentName:"table"},r.a.createElement(o.MDXTag,{name:"tr",components:n,parentName:"tbody"},r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"MrResource.pool(api: string)"),r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"mrpool"),r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"\u8fd4\u56de\u4e00\u4e2a\u57fa\u4e8e\u4e00\u4e2aMrResource\u7684\u4e00\u4e2a\u8fde\u63a5\u6c60")),r.a.createElement(o.MDXTag,{name:"tr",components:n,parentName:"tbody"},r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"mrpool.get(search?: object, params: object, options?: AxiosOptions)"),r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"Promise<any",">"),r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"\u53d1\u8d77\u4e00\u4e2aget\u8bf7\u6c42\uff0c\u8fd4\u56de\u4e00\u4e2aPromise\u5bf9\u8c61 - Content-Type ='application/json';")),r.a.createElement(o.MDXTag,{name:"tr",components:n,parentName:"tbody"},r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"mrpool.post(search?: object, payload: object, options?: AxiosOptions)"),r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"Promise<any",">"),r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"\u53d1\u8d77\u4e00\u4e2apost\u8bf7\u6c42\uff0c\u8fd4\u56de\u4e00\u4e2aPromise\u5bf9\u8c61 - Content-Type ='application/json';")),r.a.createElement(o.MDXTag,{name:"tr",components:n,parentName:"tbody"},r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"mrpool.upload(search?: object, payload: object, options?: AxiosOptions)"),r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"Promise<any",">"),r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"\u53d1\u8d77\u4e00\u4e2apost\u8bf7\u6c42\uff0c\u8fd4\u56de\u4e00\u4e2aPromise\u5bf9\u8c61, - Content-Type ='multipart/form-data';")),r.a.createElement(o.MDXTag,{name:"tr",components:n,parentName:"tbody"},r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"mrpool.download(search?: object, params: object, options?: AxiosOptions)"),r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"Promise<any",">"),r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"\u53d1\u8d77\u4e00\u4e2aget\u8bf7\u6c42\uff0c\u8fd4\u56de\u4e00\u4e2aPromise\u5bf9\u8c61, \u5e76\u81ea\u52a8\u4e0b\u8f7d - Content-Type ='application/json';")),r.a.createElement(o.MDXTag,{name:"tr",components:n,parentName:"tbody"},r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"mrpool.mrdown(search?: object, payload: object, options?: AxiosOptions)"),r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"Promise<any",">"),r.a.createElement(o.MDXTag,{name:"td",components:n,parentName:"tr",props:{align:"left"}},"\u57fa\u4e8emri\u534f\u8bae\uff0c\u53d1\u8d77\u4e00\u4e2apost\u8bf7\u6c42\uff0c\u8fd4\u56de\u4e00\u4e2aPromise\u5bf9\u8c61, \u5e76\u81ea\u52a8\u4e0b\u8f7d - Content-Type ='application/json';")))))}}])&&m(t.prototype,a),s&&m(t,s),n}()},"./src/lib/mr-common/mr-resource.ts":function(e,n,t){"use strict";var a=t("./node_modules/mzmu/index.js"),r=t.n(a),o=t("./src/lib/mr-common/mr-request.ts"),s=t("./src/lib/mr-common/mr.services.ts"),p=t("./node_modules/lodash/lodash.js");function m(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],a=!0,r=!1,o=void 0;try{for(var s,p=e[Symbol.iterator]();!(a=(s=p.next()).done)&&(t.push(s.value),!n||t.length!==n);a=!0);}catch(m){r=!0,o=m}finally{try{a||null==p.return||p.return()}finally{if(r)throw o}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,t,a;return n=e,(t=[{key:"getParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=m(e.replace(/^{(.*)}$/,"$1").split(":"),3),a=t[0],o=t[1],s=t[2],p=n[o];return r.a.isExist(p)&&(p=[a=r.a.ifnvl(a,""),p,s=r.a.ifnvl(s,"")].join("")),{key:o,value:p=r.a.ifnvl(p,"")}}},{key:"restful",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e=e||"";var o=r.a.clone(t||{}),s={},p=e.match(/{(.*?)(:.+?)}/g);return p&&p.length&&r.a.each(p,function(r){var o=n.getParams(r,t);o.key&&(a.holdParams||delete t[o.key],e=e.replace(r,o.value))}),{url:e=e.replace(/\{(.+?)\}/g,function(e,n){var p=r.a.run(o[n],function(e){return s[n]=e,o=r.a.remove(o,n),a.holdParams||delete t[n],e});return r.a.ifnvl(p,"")}),fullUrl:e,search:o,params:t,restParams:s}}},{key:"get",value:function(e,n,t){var a=this.restful(e,n,t).fullUrl;return t=r.a.extend(!0,{method:"get",params:n},t||{}),Object(o.a)(a,t)}},{key:"post",value:function(e,n,t,a){switch(arguments.length){case 1:t={},n={},a={};break;case 2:t=arguments[1],n={},a={};break;case 3:a={}}var p=this.restful(e,n,a);s.a.getHeaders();return a=r.a.extend(!0,{method:"post",headers:{"Content-Type":"application/json;"},data:t,params:n},a||{}),Object(o.a)(p.fullUrl,a)}},{key:"patch",value:function(e,n,t,a){switch(arguments.length){case 1:n={},t={},a={};break;case 2:n={},t=arguments[1],a={};break;case 3:a={}}var s=this.restful(e,n,a),p=this.restful(s.url,t,a);return a=r.a.extend(!0,{method:"patch",headers:{"Content-Type":"application/json;"},data:t,params:n},a||{}),Object(o.a)(p.fullUrl,a)}},{key:"put",value:function(e,n,t,a){switch(arguments.length){case 1:n={},t={},a={};break;case 2:n={},t=arguments[1],a={};break;case 3:a={}}var s=this.restful(e,n,a),p=this.restful(s.url,t,a);return a=r.a.extend(!0,{method:"put",headers:{"Content-Type":"application/json;"},data:t,params:n},a||{}),Object(o.a)(p.fullUrl,a)}},{key:"delete",value:function(e,n,t){var a=this.restful(e,n,t).fullUrl;return t=r.a.extend(!0,{method:"delete",params:n},t||{}),Object(o.a)(a,t)}},{key:"pool",value:function(e){var n=this;return{_url:e,get:function(t,a,o){return r.a.run(a,function(){t=r.a.extend(!0,t,a)}),n.get(e,t,o)},post:function(t,a,r){var o=Array.from(arguments);return o.unshift(e),n.post.apply(n,o)},upload:function(t,a,r){return r=r||{},p.set(r,"headers.Content-Type","multipart/form-data;"),n.post(e,t,a,r)},delete:function(t,a,r){var o=Array.from(arguments);return o.unshift(e),n.delete.apply(n,o)},patch:function(t,a,r){var o=Array.from(arguments);return o.unshift(e),n.patch.apply(n,o)},put:function(t,a,r){var o=Array.from(arguments);return o.unshift(e),n.put.apply(n,o)},save:function(t,a,r){var o=(t||a||{})[(t||a||{}).__primary__]?"patch":"post",s=Array.from(arguments);return s.unshift(e),n[o].apply(n,s)},download:function(t,a){var r=Array.from(arguments);return(a=a||{}).responseType="blob",r.unshift(e),n.get.apply(n,r).then(function(e){s.a.download(e,t.downloadName)})},mrdown:function(t,a,r){return a=a||{},r=r||{},(t=t||{}).downloadName?(t.directDownload=!0,r.responseType="blob",n.post(e,t,a,r).then(function(e){s.a.download(e,t.downloadName)})):(console.error("downloadName \u672a\u8bbe\u7f6e"),!1)}}}}])&&c(n.prototype,t),a&&c(n,a),e}();n.a=new l}}]);
//# sourceMappingURL=src-lib-mr-common-mr-resource.9028f0acc5d32fe5d026.js.map